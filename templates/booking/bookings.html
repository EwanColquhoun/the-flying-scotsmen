{% extends "booking/base.html" %}

{% block content %}


<div class="container">
    <div class="row">
        <div class="col-12 d-flex justify-content-center"><h1 class="page-heading">Bookings</h1></div>
    </div>
</div>


<div class="container">
    <div class="row g-0">
        <div class="col-12">
            <h3 class="sub-heading">Bookings for <strong class="scots">{{ request.user.username }}:</strong></h3>
                <div id="booking-content" class="d-grid gap-3 blue-border">
                    <table class="bookings">
                   
            {% if bookings %}
           
                        <tr class="table-headings">
                            <td>Date</td>
                            <td>Slot</td>
                            <td>Aircraft</td>
                            <td class="notes">Notes</td>  
                            <td>Inst Rqd</td>  
                            <td>Edit</td>
                            <td>Cancel</td>    
                        </tr>
            {% endif %}

            {% for booking in bookings %}
                {% if booking.approved == 0 %}

                        <tr class="booking-row awaiting">
                            <td>{{ booking.date|date:'d/m' }}</td>
                            <td>{{ booking.slot.slot }}</td>
                            <td>{{ booking.aircraft }}</td>
                            <td class="notes">{{ booking.notes }}</td>
                            <td>{{ booking.instructor_requested }}</td>
                            <td><span><a href="/edit/{{ booking.id }}"><i class="far fa-edit edit-icon green"></i></a></span></td>
                            <td>
                                <span><a name="{{ booking.id }}" class="delete_button" data-ref="0" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                    <i class="far fa-times-circle cancel-icon red"></i></a>
                                </span>
                            </td>
                        </tr>
                {% else %}
                        
                        <tr class="booking-row approved">
                            <td>{{ booking.date|date:'d/m' }}</td>
                            <td>{{ booking.slot.slot }}</td>
                            <td>{{ booking.aircraft }}</td>
                            <td class="notes">{{ booking.notes }}</td>
                            <td>{{ booking.instructor_requested }}</td>
                            <td><span><a href="/edit/{{ booking.id }}"><i class="far fa-edit edit-icon green"></i></a></span></td>
                            <td>
                                <span><a name="{{ booking.id }}" class="delete_button" data-ref="0" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                    <i class="far fa-times-circle cancel-icon red"></i></a>
                                </span>
                            </td>
                        </tr>
                {% endif %}
            {% empty %}
        
                        <span class="d-flex justify-content-center mt-5">Your bookings will appear here once approved by admin.</span> 
            {% endfor %}
                    </table>
                </div>
                <hr class="half-page-break">
        </div>
    </div>
     
    <div class="row g-0 d-flex justify-content-between">
        <div class="col-12 col-md-6 col-lg-5 mb-5">
            <h3 class="sub-heading">Make A New Booking</h3>

            <form id="booking-form" class="blue-border" action="{% url 'bookings' %}" method="POST">
                {% csrf_token %}
            {{ bookingform.as_p }}
            {{ bookingform.non_field_errors }}
                <div id="booking-button">
                    <button type="submit" id="new_booking" class="btn btn-join">Submit</button>
                </div>
            </form>
        </div>

        <hr id="mobile-break" class="half-page-break">

        <div class="col-12 col-md-6 col-lg-5 mb-5">
            <h3 class="sub-heading">Our Travels So Far</h3>
            <div id='map' class="blue-border">
            </div>
        </div>

    </div>
</div>

{% endblock %}